<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChargeNet EV - Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        #dashboardMap {
            height: 400px;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow);
            border: 2px solid var(--primary-color);
        }

        .station-marker {
            background: var(--primary-color);
            border: 3px solid white;
            border-radius: 50%;
            width: 12px;
            height: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .station-marker.available {
            background: var(--success-color);
        }

        .station-marker.busy {
            background: var(--warning-color);
        }

        .station-marker.offline {
            background: var(--danger-color);
        }
    </style>
</head>

<body>

    <div class="dashboard-container">
        <!-- Sidebar Navigation -->
        <aside class="dashboard-sidebar">
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#dashboard" class="sidebar-link active" data-section="dashboard"><i
                                class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="#find-stations" class="sidebar-link" data-section="find-stations"><i
                                class="fas fa-map-marker-alt"></i> Find Stations</a></li>
                    <li><a href="#bookings" class="sidebar-link" data-section="bookings"><i
                                class="fas fa-calendar-check"></i> My Bookings</a></li>
                    <li><a href="#wallet" class="sidebar-link" data-section="wallet"><i class="fas fa-wallet"></i>
                            Wallet & Payments</a></li>
                    <li><a href="#history" class="sidebar-link" data-section="history"><i class="fas fa-history"></i>
                            Charging History</a></li>
                    <li><a href="#profile" class="sidebar-link" data-section="profile"><i class="fas fa-user-cog"></i>
                            Profile & Settings</a></li>
                    <li><a href="#logout" class="sidebar-link" data-action="logout"><i class="fas fa-sign-out-alt"></i>
                            Logout</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Dashboard Content -->
        <main class="dashboard-main">
            <!-- Dashboard Overview Section -->
            <section id="dashboard" class="dashboard-section active">
                <div class="section-header">
                    <h1>Dashboard Overview</h1>
                    <p>Welcome back, John! Here's your charging summary.</p>
                </div>

                <!-- Overview Cards -->
                <div class="overview-cards">
                    <div class="overview-card">
                        <div class="card-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="card-content">
                            <h3>Total Charges</h3>
                            <span class="card-number">47</span>
                            <span class="card-label">This month</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="card-content">
                            <h3>Total Spent</h3>
                            <span class="card-number">$284.50</span>
                            <span class="card-label">This month</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="card-content">
                            <h3>CO₂ Saved</h3>
                            <span class="card-number">125kg</span>
                            <span class="card-label">This month</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">
                            <i class="fas fa-battery-full"></i>
                        </div>
                        <div class="card-content">
                            <h3>kWh Used</h3>
                            <span class="card-number">1,240</span>
                            <span class="card-label">This month</span>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Recent Charging Sessions</h3>
                        <div class="activity-list">
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-charging-station"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>Downtown Plaza Station</h4>
                                    <p>Today, 8:30 AM - 9:15 AM</p>
                                    <span class="activity-amount">45 kWh • $13.50</span>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-charging-station"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>Shopping Mall Hub</h4>
                                    <p>Yesterday, 2:00 PM - 2:45 PM</p>
                                    <span class="activity-amount">38 kWh • $11.40</span>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-charging-station"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>Airport Express Station</h4>
                                    <p>Dec 25, 6:00 PM - 6:30 PM</p>
                                    <span class="activity-amount">52 kWh • $18.20</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3>Quick Actions</h3>
                        <div class="quick-actions">
                            <button class="action-btn" onclick="showDashboardSection('find-stations')">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Find Station</span>
                            </button>
                            <button class="action-btn" onclick="showDashboardSection('bookings')">
                                <i class="fas fa-calendar-plus"></i>
                                <span>Book Slot</span>
                            </button>
                            <button class="action-btn" onclick="showDashboardSection('wallet')">
                                <i class="fas fa-credit-card"></i>
                                <span>Add Funds</span>
                            </button>
                            <button class="action-btn" onclick="showDashboardSection('profile')">
                                <i class="fas fa-cog"></i>
                                <span>Settings</span>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Find Stations Section -->
            <section id="find-stations" class="dashboard-section">
                <div class="section-header">
                    <h1>Find Charging Stations</h1>
                    <p>Discover nearby charging stations with real-time availability</p>
                </div>

                <!-- Enhanced Search and Filter Section -->
                <div class="station-search-enhanced">
                    <div class="search-container">
                        <div class="search-bar-modern">
                            <div class="search-input-group">
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="Search by location, station name, or zip code..."
                                    id="dashboardStationSearch">
                                <button class="btn btn-primary search-btn" onclick="searchDashboardStations()">
                                    <i class="fas fa-search"></i>
                                    <span>Search</span>
                                </button>
                            </div>
                            <button class="btn btn-outline filter-toggle" onclick="toggleAdvancedFilters()">
                                <i class="fas fa-sliders-h"></i>
                                <span>Filters</span>
                            </button>
                        </div>

                        <!-- Advanced Filters Panel -->
                        <div class="advanced-filters" id="advancedFilters">
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label><i class="fas fa-bolt"></i> Charger Type</label>
                                    <div class="checkbox-group">
                                        <label class="checkbox-item">
                                            <input type="checkbox" value="fast" checked>
                                            <span>Fast Charging</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" value="ultra" checked>
                                            <span>Ultra-Fast DC</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" value="standard" checked>
                                            <span>Standard</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="filter-group">
                                    <label><i class="fas fa-clock"></i> Availability</label>
                                    <div class="checkbox-group">
                                        <label class="checkbox-item">
                                            <input type="checkbox" value="available" checked>
                                            <span>Available Now</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" value="busy">
                                            <span>Busy</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" value="offline">
                                            <span>Offline</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="filter-group">
                                    <label><i class="fas fa-dollar-sign"></i> Price Range</label>
                                    <div class="price-range">
                                        <input type="range" min="0" max="50" value="35" class="price-slider">
                                        <span class="price-value">$0.00 - $<span id="maxPrice">35</span>/kWh</span>
                                    </div>
                                </div>
                            </div>

                            <div class="filter-actions">
                                <button class="btn btn-outline" onclick="clearFilters()">Clear All</button>
                                <button class="btn btn-primary" onclick="applyFilters()">Apply Filters</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map and Results Layout -->
                <div class="station-results-layout">
                    <!-- Interactive Map -->
                    <div class="map-section">
                        <div class="map-container">
                            <div id="dashboardMap"></div>
                            <div class="map-controls">
                                <button class="map-control-btn" onclick="resetDashboardMap()">
                                    <i class="fas fa-home"></i>
                                </button>
                                <button class="map-control-btn" onclick="toggleMapFullscreen()">
                                    <i class="fas fa-expand"></i>
                                </button>
                                <button class="map-control-btn" onclick="toggleMapStyle()">
                                    <i class="fas fa-layer-group"></i>
                                </button>
                            </div>
                            <div class="map-legend">
                                <div class="legend-item">
                                    <span class="legend-dot available"></span>
                                    <span>Available</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-dot busy"></span>
                                    <span>Busy</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-dot offline"></span>
                                    <span>Offline</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Station Results -->
                    <div class="results-section">
                        <div class="results-header">
                            <div class="results-info">
                                <h3>Nearby Stations</h3>
                                <span class="results-count">15 stations found</span>
                            </div>
                            <div class="results-sort">
                                <select class="sort-select" onchange="sortStations(this.value)">
                                    <option value="distance">Sort by Distance</option>
                                    <option value="availability">Sort by Availability</option>
                                    <option value="price">Sort by Price</option>
                                    <option value="rating">Sort by Rating</option>
                                </select>
                            </div>
                        </div>

                        <div class="station-list-enhanced">
                            <!-- Station Card 1 -->
                            <div class="station-card-enhanced available">
                                <div class="station-visual">
                                    <div class="station-image">
                                        <img src="assets/images/station-1.jpg" alt="Downtown Plaza Station">
                                        <div class="station-status-badge available">
                                            <i class="fas fa-check-circle"></i>
                                            <span>4 Available</span>
                                        </div>
                                    </div>
                                    <div class="station-distance">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>0.5 mi</span>
                                    </div>
                                </div>

                                <div class="station-content">
                                    <div class="station-header">
                                        <div class="station-title">
                                            <h4>Downtown Plaza Station</h4>
                                            <div class="station-rating">
                                                <i class="fas fa-star"></i>
                                                <span>4.8</span>
                                                <span class="rating-count">(124)</span>
                                            </div>
                                        </div>
                                        <div class="station-price">
                                            <span class="price-label">from</span>
                                            <span class="price-value">$0.25/kWh</span>
                                        </div>
                                    </div>

                                    <div class="station-location">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>123 Main Street, Downtown</span>
                                    </div>

                                    <div class="station-features">
                                        <div class="feature-tag">
                                            <i class="fas fa-bolt"></i>
                                            <span>Fast</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-bolt"></i>
                                            <span>Ultra-Fast DC</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-wifi"></i>
                                            <span>WiFi</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-coffee"></i>
                                            <span>Cafe</span>
                                        </div>
                                    </div>

                                    <div class="station-actions">
                                        <button class="btn btn-primary" onclick="bookStation('downtown-plaza')">
                                            <i class="fas fa-calendar-plus"></i>
                                            Book Now
                                        </button>
                                        <button class="btn btn-outline" onclick="getDirections('downtown-plaza')">
                                            <i class="fas fa-directions"></i>
                                            Directions
                                        </button>
                                        <button class="btn btn-ghost" onclick="viewStationDetails('downtown-plaza')">
                                            <i class="fas fa-info-circle"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Station Card 2 -->
                            <div class="station-card-enhanced available">
                                <div class="station-visual">
                                    <div class="station-image">
                                        <img src="assets/images/station-2.jpg" alt="Shopping Mall Hub">
                                        <div class="station-status-badge available">
                                            <i class="fas fa-check-circle"></i>
                                            <span>2 Available</span>
                                        </div>
                                    </div>
                                    <div class="station-distance">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>1.2 mi</span>
                                    </div>
                                </div>

                                <div class="station-content">
                                    <div class="station-header">
                                        <div class="station-title">
                                            <h4>Shopping Mall Hub</h4>
                                            <div class="station-rating">
                                                <i class="fas fa-star"></i>
                                                <span>4.6</span>
                                                <span class="rating-count">(89)</span>
                                            </div>
                                        </div>
                                        <div class="station-price">
                                            <span class="price-label">from</span>
                                            <span class="price-value">$0.30/kWh</span>
                                        </div>
                                    </div>

                                    <div class="station-location">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>456 Commerce Ave, Mall District</span>
                                    </div>

                                    <div class="station-features">
                                        <div class="feature-tag">
                                            <i class="fas fa-bolt"></i>
                                            <span>Fast</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-bolt"></i>
                                            <span>Standard</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-shopping-bag"></i>
                                            <span>Shopping</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-utensils"></i>
                                            <span>Food Court</span>
                                        </div>
                                    </div>

                                    <div class="station-actions">
                                        <button class="btn btn-primary" onclick="bookStation('shopping-mall')">
                                            <i class="fas fa-calendar-plus"></i>
                                            Book Now
                                        </button>
                                        <button class="btn btn-outline" onclick="getDirections('shopping-mall')">
                                            <i class="fas fa-directions"></i>
                                            Directions
                                        </button>
                                        <button class="btn btn-ghost" onclick="viewStationDetails('shopping-mall')">
                                            <i class="fas fa-info-circle"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Station Card 3 -->
                            <div class="station-card-enhanced busy">
                                <div class="station-visual">
                                    <div class="station-image">
                                        <img src="assets/images/station-3.jpg" alt="Airport Express Station">
                                        <div class="station-status-badge busy">
                                            <i class="fas fa-clock"></i>
                                            <span>1 Available</span>
                                        </div>
                                    </div>
                                    <div class="station-distance">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>2.8 mi</span>
                                    </div>
                                </div>

                                <div class="station-content">
                                    <div class="station-header">
                                        <div class="station-title">
                                            <h4>Airport Express Station</h4>
                                            <div class="station-rating">
                                                <i class="fas fa-star"></i>
                                                <span>4.9</span>
                                                <span class="rating-count">(201)</span>
                                            </div>
                                        </div>
                                        <div class="station-price">
                                            <span class="price-label">from</span>
                                            <span class="price-value">$0.35/kWh</span>
                                        </div>
                                    </div>

                                    <div class="station-location">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>789 Airport Road, Terminal 2</span>
                                    </div>

                                    <div class="station-features">
                                        <div class="feature-tag">
                                            <i class="fas fa-bolt"></i>
                                            <span>Ultra-Fast DC</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-bolt"></i>
                                            <span>Fast</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-luggage-cart"></i>
                                            <span>Luggage</span>
                                        </div>
                                        <div class="feature-tag">
                                            <i class="fas fa-couch"></i>
                                            <span>Lounge</span>
                                        </div>
                                    </div>

                                    <div class="station-actions">
                                        <button class="btn btn-primary" onclick="bookStation('airport')">
                                            <i class="fas fa-calendar-plus"></i>
                                            Book Now
                                        </button>
                                        <button class="btn btn-outline" onclick="getDirections('airport')">
                                            <i class="fas fa-directions"></i>
                                            Directions
                                        </button>
                                        <button class="btn btn-ghost" onclick="viewStationDetails('airport')">
                                            <i class="fas fa-info-circle"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Load More Button -->
                        <div class="load-more-container">
                            <button class="btn btn-outline load-more-btn" onclick="loadMoreStations()">
                                <i class="fas fa-plus-circle"></i>
                                Load More Stations
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- My Bookings Section -->
            <section id="bookings" class="dashboard-section">
                <div class="section-header">
                    <h1>My Bookings</h1>
                    <p>Manage your charging slot reservations</p>
                </div>

                <div class="booking-tabs">
                    <button class="tab-btn active" onclick="showBookingTab('upcoming')">Upcoming</button>
                    <button class="tab-btn" onclick="showBookingTab('past')">Past Bookings</button>
                    <button class="tab-btn" onclick="showBookingTab('cancelled')">Cancelled</button>
                </div>

                <div id="upcoming-bookings" class="booking-content active">
                    <div class="booking-card">
                        <div class="booking-header">
                            <h3>Downtown Plaza Station</h3>
                            <span class="booking-status confirmed">Confirmed</span>
                        </div>
                        <div class="booking-details">
                            <div class="booking-info">
                                <p><i class="fas fa-calendar"></i> December 28, 2024</p>
                                <p><i class="fas fa-clock"></i> 2:00 PM - 3:00 PM</p>
                                <p><i class="fas fa-bolt"></i> Fast Charging - Bay 3</p>
                            </div>
                            <div class="booking-actions">
                                <button class="btn btn-outline">Modify</button>
                                <button class="btn btn-danger">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <div class="booking-card">
                        <div class="booking-header">
                            <h3>Airport Express Station</h3>
                            <span class="booking-status confirmed">Confirmed</span>
                        </div>
                        <div class="booking-details">
                            <div class="booking-info">
                                <p><i class="fas fa-calendar"></i> December 30, 2024</p>
                                <p><i class="fas fa-clock"></i> 10:00 AM - 11:00 AM</p>
                                <p><i class="fas fa-bolt"></i> Ultra-Fast DC - Bay 1</p>
                            </div>
                            <div class="booking-actions">
                                <button class="btn btn-outline">Modify</button>
                                <button class="btn btn-danger">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="past-bookings" class="booking-content">
                    <div class="booking-card completed">
                        <div class="booking-header">
                            <h3>Shopping Mall Hub</h3>
                            <span class="booking-status completed">Completed</span>
                        </div>
                        <div class="booking-details">
                            <div class="booking-info">
                                <p><i class="fas fa-calendar"></i> December 25, 2024</p>
                                <p><i class="fas fa-clock"></i> 2:00 PM - 2:45 PM</p>
                                <p><i class="fas fa-bolt"></i> Fast Charging - 38 kWh</p>
                            </div>
                            <div class="booking-actions">
                                <button class="btn btn-outline">Book Again</button>
                                <button class="btn btn-outline">View Receipt</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="cancelled-bookings" class="booking-content">
                    <p>No cancelled bookings</p>
                </div>
            </section>

            <!-- Wallet & Payments Section -->
            <section id="wallet" class="dashboard-section">
                <div class="section-header">
                    <h1>Wallet & Payments</h1>
                    <p>Manage your payment methods and wallet balance</p>
                </div>

                <div class="wallet-overview">
                    <div class="wallet-balance">
                        <h3>Current Balance</h3>
                        <div class="balance-amount">$45.75</div>
                        <div class="wallet-actions">
                            <button class="btn btn-primary" onclick="showAddFundsModal()">Add Funds</button>
                            <button class="btn btn-outline">Transaction History</button>
                        </div>
                    </div>

                    <div class="payment-methods">
                        <h3>Payment Methods</h3>
                        <div class="payment-list">
                            <div class="payment-item">
                                <div class="payment-icon">
                                    <i class="fab fa-cc-visa"></i>
                                </div>
                                <div class="payment-info">
                                    <h4>Visa ending in 4242</h4>
                                    <p>Expires 12/25</p>
                                </div>
                                <div class="payment-status">
                                    <span class="status-badge default">Default</span>
                                </div>
                            </div>
                            <div class="payment-item">
                                <div class="payment-icon">
                                    <i class="fab fa-cc-mastercard"></i>
                                </div>
                                <div class="payment-info">
                                    <h4>Mastercard ending in 8888</h4>
                                    <p>Expires 09/26</p>
                                </div>
                                <div class="payment-actions">
                                    <button class="btn btn-outline">Set Default</button>
                                    <button class="btn btn-danger">Remove</button>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-outline" onclick="showAddPaymentModal()">Add Payment Method</button>
                    </div>
                </div>

                <div class="recent-transactions">
                    <h3>Recent Transactions</h3>
                    <div class="transaction-list">
                        <div class="transaction-item">
                            <div class="transaction-icon">
                                <i class="fas fa-minus-circle"></i>
                            </div>
                            <div class="transaction-details">
                                <h4>Charging Session</h4>
                                <p>Downtown Plaza Station</p>
                                <span class="transaction-date">Today, 8:30 AM</span>
                            </div>
                            <div class="transaction-amount negative">-$13.50</div>
                        </div>
                        <div class="transaction-item">
                            <div class="transaction-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <div class="transaction-details">
                                <h4>Wallet Top-up</h4>
                                <p>Added via Visa ****4242</p>
                                <span class="transaction-date">Dec 26, 2024</span>
                            </div>
                            <div class="transaction-amount positive">+$50.00</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Charging History Section -->
            <section id="history" class="dashboard-section">
                <div class="section-header">
                    <h1>Charging History</h1>
                    <p>View your complete charging history and get support</p>
                </div>

                <!-- Enhanced Filters and Actions -->
                <div class="history-controls">
                    <div class="history-filters">
                        <select class="filter-select" onchange="filterHistory(this.value)">
                            <option value="30">Last 30 Days</option>
                            <option value="90">Last 3 Months</option>
                            <option value="180">Last 6 Months</option>
                            <option value="365">Last Year</option>
                            <option value="all">All Time</option>
                        </select>
                        <div class="filter-buttons">
                            <button class="btn btn-outline" onclick="exportHistory()">
                                <i class="fas fa-download"></i>
                                Export
                            </button>
                            <button class="btn btn-primary" onclick="toggleChatSupport()">
                                <i class="fas fa-comments"></i>
                                Chat Support
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Statistics Cards -->
                <div class="history-stats-enhanced">
                    <div class="stat-card-enhanced primary">
                        <div class="stat-icon">
                            <i class="fas fa-charging-station"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Total Sessions</h3>
                            <span class="stat-number" data-target="156">0</span>
                            <span class="stat-change positive">+12% this month</span>
                        </div>
                    </div>
                    <div class="stat-card-enhanced success">
                        <div class="stat-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Total kWh</h3>
                            <span class="stat-number" data-target="4280">0</span>
                            <span class="stat-change positive">+8% this month</span>
                        </div>
                    </div>
                    <div class="stat-card-enhanced warning">
                        <div class="stat-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Total Spent</h3>
                            <span class="stat-number">$1,284</span>
                            <span class="stat-change positive">+5% this month</span>
                        </div>
                    </div>
                    <div class="stat-card-enhanced info">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Avg Cost/kWh</h3>
                            <span class="stat-number">$0.30</span>
                            <span class="stat-change negative">+2% this month</span>
                        </div>
                    </div>
                </div>

                <!-- Interactive Chart Section -->
                <div class="history-chart-enhanced">
                    <div class="chart-header">
                        <h3>Charging Trends</h3>
                        <div class="chart-controls">
                            <button class="chart-btn active" data-chart="weekly">Weekly</button>
                            <button class="chart-btn" data-chart="monthly">Monthly</button>
                            <button class="chart-btn" data-chart="yearly">Yearly</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="chargingChart"></canvas>
                    </div>
                </div>

                <!-- Enhanced Session History with Chat -->
                <div class="history-content">
                    <div class="history-main">
                        <div class="history-header">
                            <h3>Recent Sessions</h3>
                            <div class="view-toggle">
                                <button class="view-btn active" data-view="cards">
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button class="view-btn" data-view="table">
                                    <i class="fas fa-table"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Card View -->
                        <div class="history-cards" id="historyCards">
                            <!-- Session Card 1 -->
                            <div class="session-card">
                                <div class="session-header">
                                    <div class="session-info">
                                        <div class="session-station">
                                            <i class="fas fa-charging-station"></i>
                                            <div>
                                                <h4>Downtown Plaza Station</h4>
                                                <p>Dec 27, 2024 • 8:30 AM</p>
                                            </div>
                                        </div>
                                        <div class="session-status completed">
                                            <i class="fas fa-check-circle"></i>
                                            <span>Completed</span>
                                        </div>
                                    </div>
                                    <div class="session-actions">
                                        <button class="btn btn-outline btn-small" onclick="viewReceipt('session-1')">
                                            <i class="fas fa-receipt"></i>
                                            Receipt
                                        </button>
                                        <button class="btn btn-primary btn-small"
                                            onclick="startSessionChat('session-1')">
                                            <i class="fas fa-comment"></i>
                                            Chat
                                        </button>
                                    </div>
                                </div>
                                <div class="session-details">
                                    <div class="session-stats">
                                        <div class="stat">
                                            <span class="label">Duration</span>
                                            <span class="value">45 min</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Energy</span>
                                            <span class="value">45 kWh</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Cost</span>
                                            <span class="value">$13.50</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Type</span>
                                            <span class="value">Fast</span>
                                        </div>
                                    </div>
                                    <div class="session-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 100%"></div>
                                        </div>
                                        <span class="progress-text">Full Charge</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Session Card 2 -->
                            <div class="session-card">
                                <div class="session-header">
                                    <div class="session-info">
                                        <div class="session-station">
                                            <i class="fas fa-charging-station"></i>
                                            <div>
                                                <h4>Shopping Mall Hub</h4>
                                                <p>Dec 26, 2024 • 2:00 PM</p>
                                            </div>
                                        </div>
                                        <div class="session-status completed">
                                            <i class="fas fa-check-circle"></i>
                                            <span>Completed</span>
                                        </div>
                                    </div>
                                    <div class="session-actions">
                                        <button class="btn btn-outline btn-small" onclick="viewReceipt('session-2')">
                                            <i class="fas fa-receipt"></i>
                                            Receipt
                                        </button>
                                        <button class="btn btn-primary btn-small"
                                            onclick="startSessionChat('session-2')">
                                            <i class="fas fa-comment"></i>
                                            Chat
                                        </button>
                                    </div>
                                </div>
                                <div class="session-details">
                                    <div class="session-stats">
                                        <div class="stat">
                                            <span class="label">Duration</span>
                                            <span class="value">38 min</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Energy</span>
                                            <span class="value">38 kWh</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Cost</span>
                                            <span class="value">$11.40</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Type</span>
                                            <span class="value">Fast</span>
                                        </div>
                                    </div>
                                    <div class="session-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 85%"></div>
                                        </div>
                                        <span class="progress-text">85% Charged</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Session Card 3 -->
                            <div class="session-card">
                                <div class="session-header">
                                    <div class="session-info">
                                        <div class="session-station">
                                            <i class="fas fa-charging-station"></i>
                                            <div>
                                                <h4>Airport Express Station</h4>
                                                <p>Dec 25, 2024 • 6:00 PM</p>
                                            </div>
                                        </div>
                                        <div class="session-status completed">
                                            <i class="fas fa-check-circle"></i>
                                            <span>Completed</span>
                                        </div>
                                    </div>
                                    <div class="session-actions">
                                        <button class="btn btn-outline btn-small" onclick="viewReceipt('session-3')">
                                            <i class="fas fa-receipt"></i>
                                            Receipt
                                        </button>
                                        <button class="btn btn-primary btn-small"
                                            onclick="startSessionChat('session-3')">
                                            <i class="fas fa-comment"></i>
                                            Chat
                                        </button>
                                    </div>
                                </div>
                                <div class="session-details">
                                    <div class="session-stats">
                                        <div class="stat">
                                            <span class="label">Duration</span>
                                            <span class="value">30 min</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Energy</span>
                                            <span class="value">52 kWh</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Cost</span>
                                            <span class="value">$18.20</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Type</span>
                                            <span class="value">Ultra-Fast</span>
                                        </div>
                                    </div>
                                    <div class="session-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 100%"></div>
                                        </div>
                                        <span class="progress-text">Full Charge</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Table View (Hidden by default) -->
                        <div class="history-table-enhanced" id="historyTable" style="display: none;">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Date & Time</th>
                                        <th>Station</th>
                                        <th>Duration</th>
                                        <th>Energy</th>
                                        <th>Cost</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <div class="date-info">
                                                <strong>Dec 27, 2024</strong>
                                                <span>8:30 AM</span>
                                            </div>
                                        </td>
                                        <td>Downtown Plaza</td>
                                        <td>45 min</td>
                                        <td>45 kWh</td>
                                        <td>$13.50</td>
                                        <td><span class="status-badge completed">Completed</span></td>
                                        <td>
                                            <div class="table-actions">
                                                <button class="btn btn-outline btn-small"
                                                    onclick="viewReceipt('session-1')">
                                                    <i class="fas fa-receipt"></i>
                                                </button>
                                                <button class="btn btn-primary btn-small"
                                                    onclick="startSessionChat('session-1')">
                                                    <i class="fas fa-comment"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="date-info">
                                                <strong>Dec 26, 2024</strong>
                                                <span>2:00 PM</span>
                                            </div>
                                        </td>
                                        <td>Shopping Mall</td>
                                        <td>38 min</td>
                                        <td>38 kWh</td>
                                        <td>$11.40</td>
                                        <td><span class="status-badge completed">Completed</span></td>
                                        <td>
                                            <div class="table-actions">
                                                <button class="btn btn-outline btn-small"
                                                    onclick="viewReceipt('session-2')">
                                                    <i class="fas fa-receipt"></i>
                                                </button>
                                                <button class="btn btn-primary btn-small"
                                                    onclick="startSessionChat('session-2')">
                                                    <i class="fas fa-comment"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="date-info">
                                                <strong>Dec 25, 2024</strong>
                                                <span>6:00 PM</span>
                                            </div>
                                        </td>
                                        <td>Airport Express</td>
                                        <td>30 min</td>
                                        <td>52 kWh</td>
                                        <td>$18.20</td>
                                        <td><span class="status-badge completed">Completed</span></td>
                                        <td>
                                            <div class="table-actions">
                                                <button class="btn btn-outline btn-small"
                                                    onclick="viewReceipt('session-3')">
                                                    <i class="fas fa-receipt"></i>
                                                </button>
                                                <button class="btn btn-primary btn-small"
                                                    onclick="startSessionChat('session-3')">
                                                    <i class="fas fa-comment"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Chat Support Panel -->
                    <div class="chat-support-panel" id="chatSupportPanel">
                        <div class="chat-header">
                            <div class="chat-info">
                                <div class="chat-avatar">
                                    <i class="fas fa-headset"></i>
                                </div>
                                <div>
                                    <h4>Support Chat</h4>
                                    <span class="chat-status online">Online</span>
                                </div>
                            </div>
                            <div class="chat-actions">
                                <button class="btn btn-ghost" onclick="minimizeChat()">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <button class="btn btn-ghost" onclick="closeChat()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>

                        <div class="chat-messages" id="chatMessages">
                            <div class="message support">
                                <div class="message-avatar">
                                    <i class="fas fa-headset"></i>
                                </div>
                                <div class="message-content">
                                    <p>Hi! I'm here to help you with your charging history. What would you like to know?
                                    </p>
                                    <span class="message-time">2:30 PM</span>
                                </div>
                            </div>
                        </div>

                        <div class="chat-input">
                            <div class="input-group">
                                <input type="text" placeholder="Type your message..." id="chatInput">
                                <button class="btn btn-primary" onclick="sendMessage()">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-btn" onclick="sendQuickMessage('billing')">Billing
                                    Question</button>
                                <button class="quick-btn" onclick="sendQuickMessage('station')">Station Issue</button>
                                <button class="quick-btn" onclick="sendQuickMessage('refund')">Refund Request</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Load More -->
                <div class="load-more-section">
                    <button class="btn btn-outline" onclick="loadMoreHistory()">
                        <i class="fas fa-plus-circle"></i>
                        Load More Sessions
                    </button>
                </div>
            </section>

            <!-- Profile & Settings Section -->
            <section id="profile" class="dashboard-section">
                <div class="section-header">
                    <h1>Profile & Settings</h1>
                    <p>Manage your account settings and preferences</p>
                </div>

                <div class="profile-grid">
                    <div class="profile-card personal-info-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-user"></i>
                                <span class="status-badge verified">Verified Profile</span>
                            </div>
                        </div>
                        <div class="personal-info-content">

                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-icon">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <div class="info-details">
                                        <label>Full Name</label>
                                        <input type="text" value="John Doe" readonly class="info-input">
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-icon">
                                        <i class="fas fa-envelope"></i>
                                    </div>
                                    <div class="info-details">
                                        <label>Email Address</label>
                                        <input type="email" value="john.doe@example.com" readonly class="info-input">
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-icon">
                                        <i class="fas fa-phone"></i>
                                    </div>
                                    <div class="info-details">
                                        <label>Phone Number</label>
                                        <input type="tel" value="+1 (555) 123-4567" readonly class="info-input">
                                    </div>
                                </div>
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-primary btn-full" onclick="enableEditProfile()">
                                    <i class="fas fa-edit"></i>
                                    Edit Profile
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="profile-card">
                        <h3>Vehicle Information</h3>
                        <div class="vehicle-list">
                            <div class="vehicle-item">
                                <div class="vehicle-icon">
                                    <i class="fas fa-car"></i>
                                </div>
                                <div class="vehicle-details">
                                    <h4>Tesla Model 3</h4>
                                    <p>2023 • Long Range</p>
                                    <span class="vehicle-badge primary">Primary</span>
                                </div>

                                <button class="btn btn-outline btn-small">Edit</button>
                            </div>
                        </div>
                        <button class="btn btn-outline">Add Vehicle</button>
                    </div>

                    <div class="profile-card">
                        <h3>Notifications</h3>
                        <div class="notification-settings">
                            <div class="setting-item">
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                                <div class="setting-info">
                                    <h4>Booking Reminders</h4>
                                    <p>Get notified before your charging sessions</p>
                                </div>
                            </div>
                            <div class="setting-item">
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                                <div class="setting-info">
                                    <h4>Station Availability</h4>
                                    <p>Alerts when nearby stations become available</p>
                                </div>
                            </div>
                            <div class="setting-item">
                                <label class="switch">
                                    <input type="checkbox">
                                    <span class="slider"></span>
                                </label>
                                <div class="setting-info">
                                    <h4>Promotional Offers</h4>
                                    <p>Receive special deals and discounts</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="profile-card">
                        <h3>Preferences</h3>
                        <div class="preference-settings">
                            <div class="setting-item">
                                <label class="switch">
                                    <input type="checkbox" id="darkModeToggle">
                                    <span class="slider"></span>
                                </label>
                                <div class="setting-info">
                                    <h4>Dark Mode</h4>
                                    <p>Toggle dark theme for the dashboard</p>
                                </div>
                            </div>
                            <div class="setting-item">
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                                <div class="setting-info">
                                    <h4>Auto-book Favorite Stations</h4>
                                    <p>Automatically book your preferred stations</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>



    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="js/script.js"></script>
    <script src="js/dashboard-nav-fix.js"></script>
    <script>
        // Simple test to verify JavaScript is working
        console.log('Dashboard page loaded');

        // Fallback navigation system
        function initFallbackNavigation() {
            console.log('Initializing fallback navigation...');
            
            const sidebarLinks = document.querySelectorAll('.sidebar-link');
            console.log(`Found ${sidebarLinks.length} sidebar links for fallback`);
            
            sidebarLinks.forEach((link, index) => {
                // Remove existing listeners
                const newLink = link.cloneNode(true);
                link.parentNode.replaceChild(newLink, link);
                
                // Add fresh listener
                newLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log(`Fallback: Clicked ${this.textContent.trim()}`);
                    
                    if (this.dataset.action === 'logout') {
                        console.log('Logout clicked');
                        if (confirm('Are you sure you want to logout?')) {
                            window.location.href = 'login.html';
                        }
                        return;
                    }
                    
                    const section = this.dataset.section || this.getAttribute('href').substring(1);
                    console.log(`Fallback: Navigating to ${section}`);
                    
                    // Simple section switching
                    const sections = document.querySelectorAll('.dashboard-section');
                    sections.forEach(s => s.classList.remove('active'));
                    
                    const targetSection = document.getElementById(section);
                    if (targetSection) {
                        targetSection.classList.add('active');
                        console.log(`Fallback: Successfully showed ${section}`);
                        
                        // Update sidebar
                        sidebarLinks.forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                    } else {
                        console.error(`Fallback: Section ${section} not found`);
                    }
                });
            });
        }
        
        // Initialize fallback after a short delay
        setTimeout(initFallbackNavigation, 1000);
        
        // Also initialize on DOM ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initFallbackNavigation);
        } else {
            initFallbackNavigation();
        }

        // Test function to verify sidebar links
        function testSidebarLinks() {
            const links = document.querySelectorAll('.sidebar-link');
            console.log('Found sidebar links:', links.length);
            links.forEach((link, index) => {
                console.log(`Link ${index}:`, link.textContent, link.dataset.section);
            });
        }

        // Test when page loads
        document.addEventListener('DOMContentLoaded', function () {
            console.log('DOM Content Loaded');
            setTimeout(testSidebarLinks, 1000);

            // Add direct click test to sidebar links
            const sidebarLinks = document.querySelectorAll('.sidebar-link');
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    console.log('Direct click test - link clicked:', this.textContent);
                    console.log('Data section:', this.dataset.section);

                    // Simple section switch test
                    const section = this.dataset.section || this.getAttribute('href').substring(1);
                    console.log('Switching to section:', section);

                    // Hide all sections
                    document.querySelectorAll('.dashboard-section').forEach(s => {
                        s.classList.remove('active');
                    });

                    // Show target section
                    const targetSection = document.getElementById(section);
                    if (targetSection) {
                        targetSection.classList.add('active');
                        console.log('Section activated successfully');
                    } else {
                        console.error('Section not found:', section);
                    }

                    // Update active state
                    document.querySelectorAll('.sidebar-link').forEach(l => {
                        l.classList.remove('active');
                    });
                    this.classList.add('active');

                    // Initialize map if find-stations section
                    if (section === 'find-stations') {
                        console.log('Initializing map for find-stations section');
                        setTimeout(() => {
                            if (typeof initDashboardMap === 'function') {
                                initDashboardMap();
                            } else {
                                console.error('initDashboardMap function not found');
                            }
                        }, 500);
                    }
                });
            });
        });
    </script>
    <script>
        // Dashboard Map
        let dashboardMap;
        let dashboardMarkers = [];
        let currentDashboardFilter = 'all';

        // Station data for dashboard
        const dashboardStations = [
            { id: 1, name: 'Downtown Plaza Station', lat: 40.7128, lng: -74.0060, available: 4, total: 8, type: 'fast' },
            { id: 2, name: 'Shopping Mall Hub', lat: 40.7580, lng: -73.9855, available: 2, total: 6, type: 'ultra' },
            { id: 3, name: 'Airport Express Station', lat: 40.6413, lng: -73.7781, available: 1, total: 4, type: 'fast' },
            { id: 4, name: 'University Campus Station', lat: 40.8075, lng: -73.9626, available: 3, total: 5, type: 'standard' },
            { id: 5, name: 'Highway Service Station', lat: 40.8303, lng: -73.9419, available: 0, total: 3, type: 'ultra' },
            { id: 6, name: 'Residential Complex Station', lat: 40.7489, lng: -73.9680, available: 5, total: 7, type: 'standard' }
        ];

        function initDashboardMap() {
            // Create map centered on user location (New York City)
            dashboardMap = L.map('dashboardMap').setView([40.7128, -74.0060], 12);

            // Add tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors',
                maxZoom: 18
            }).addTo(dashboardMap);

            // Add user location marker
            const userIcon = L.divIcon({
                className: 'user-marker',
                html: '<div style="background: #4285f4; border: 3px solid white; border-radius: 50%; width: 16px; height: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',
                iconSize: [16, 16],
                iconAnchor: [8, 8]
            });

            L.marker([40.7128, -74.0060], { icon: userIcon })
                .bindPopup('<strong>Your Location</strong>')
                .addTo(dashboardMap);

            // Add station markers
            addDashboardStationMarkers();
        }

        function addDashboardStationMarkers() {
            // Clear existing markers
            dashboardMarkers.forEach(marker => dashboardMap.removeLayer(marker));
            dashboardMarkers = [];

            dashboardStations.forEach(station => {
                // Determine marker color based on availability
                let markerClass = 'available';
                if (station.available === 0) {
                    markerClass = 'offline';
                } else if (station.available < station.total / 2) {
                    markerClass = 'busy';
                }

                // Create custom icon
                const icon = L.divIcon({
                    className: `station-marker ${markerClass}`,
                    iconSize: [12, 12],
                    iconAnchor: [6, 6]
                });

                // Create popup content
                const popupContent = `
                    <div style="min-width: 200px;">
                        <h4 style="margin: 0 0 8px 0; color: #333;">${station.name}</h4>
                        <p style="margin: 4px 0; font-size: 14px;">
                            <strong>Available:</strong> ${station.available}/${station.total}
                        </p>
                        <p style="margin: 4px 0; font-size: 14px;">
                            <strong>Type:</strong> ${station.type.charAt(0).toUpperCase() + station.type.slice(1)}
                        </p>
                        <button onclick="bookStationFromDashboardMap(${station.id})" 
                                style="margin-top: 8px; padding: 6px 12px; background: #0066cc; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            Book Slot
                        </button>
                    </div>
                `;

                // Create and add marker
                const marker = L.marker([station.lat, station.lng], { icon })
                    .bindPopup(popupContent)
                    .addTo(dashboardMap);

                dashboardMarkers.push(marker);
            });
        }

        function resetDashboardMap() {
            dashboardMap.setView([40.7128, -74.0060], 12);
        }

        function toggleDashboardStationTypes() {
            const types = ['all', 'fast', 'ultra', 'standard'];
            const currentIndex = types.indexOf(currentDashboardFilter);
            currentDashboardFilter = types[(currentIndex + 1) % types.length];

            showNotification(`Showing: ${currentDashboardFilter.charAt(0).toUpperCase() + currentDashboardFilter.slice(1)} chargers`, 'info');
            addDashboardStationMarkers();
        }

        function bookStationFromDashboardMap(stationId) {
            const station = dashboardStations.find(s => s.id === stationId);
            if (station) {
                showNotification(`Opening booking for ${station.name}...`, 'info');
                setTimeout(() => {
                    window.location.href = 'stations.html';
                }, 1000);
            }
        }

        function searchDashboardStations() {
            const searchTerm = document.getElementById('dashboardStationSearch').value.trim();
            if (!searchTerm) {
                showNotification('Please enter a location to search', 'warning');
                return;
            }
            showNotification(`Searching for stations near ${searchTerm}...`, 'info');
            setTimeout(() => {
                showNotification('Found 6 stations nearby', 'success');
            }, 1000);
        }

        // Initialize dashboard map when find-stations section is shown
        document.addEventListener('DOMContentLoaded', function () {
            // Wait for page to load
            setTimeout(() => {
                // Check if find-stations section is active
                const findStationsSection = document.getElementById('find-stations');
                if (findStationsSection && findStationsSection.classList.contains('active')) {
                    initDashboardMap();
                }
            }, 500);
        });

        // Override the showDashboardSection function to initialize map when needed
        const originalShowDashboardSection = window.showDashboardSection;
        window.showDashboardSection = function (section) {
            if (originalShowDashboardSection) {
                originalShowDashboardSection(section);
            }

            if (section === 'find-stations' && !dashboardMap) {
                setTimeout(() => {
                    initDashboardMap();
                }, 100);
            }
        };
    </script>
</body>

</html>